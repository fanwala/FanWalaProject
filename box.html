<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Blade Box Master</title>

<style>
body{
margin:0;
font-family:Arial;
}

/* Sidebar */
.sidebar{
width:260px;
height:100vh;
background:#b3e5fc;
position:fixed;
left:0;
top:0;
padding-top:20px;
}

.menu-item{
padding:12px 20px;
cursor:pointer;
font-weight:bold;
}

.menu-item:hover{
background:#81d4fa;
}

.submenu{
display:none;
padding-left:15px;
}

.submenu div{
padding:10px 20px;
cursor:pointer;
}

.submenu div:hover{
background:#4fc3f7;
color:white;
}

/* Content */
.content{
margin-left:270px;
padding:40px;
}

input{
width:100%;
padding:8px;
margin-top:5px;
margin-bottom:15px;
}

button{
padding:6px 15px;
cursor:pointer;
}

table{
width:100%;
border-collapse:collapse;
}

table,th,td{
border:1px solid #bdbdbd;
}

th{
background:#9ec9dd;
}

th,td{
padding:10px;
text-align:center;
}

.action-btn{
padding:5px 10px;
margin:2px;
}
</style>
</head>

<body>

<!-- Sidebar -->
<div class="sidebar">

<div class="menu-item" onclick="toggleMenu('ordersMenu')">ORDERS</div>

<div id="ordersMenu" class="submenu">

<div class="menu-item" onclick="toggleMenu('bladesMenu')">Blades</div>

<div id="bladesMenu" class="submenu">

<div onclick="openPage('add_blades.html')">Add</div>
<div onclick="openPage('show_blades.html')">Show</div>

<div class="menu-item" onclick="toggleMenu('bladeMastersMenu')">
Blade Masters
</div>

<div id="bladeMastersMenu" class="submenu">

<div onclick="openPage('blade_models.html')">Model Names</div>
<div onclick="openPage('blade_parties.html')">Party Names</div>
<div onclick="openPage('box.html')">Box Master</div>

</div>

</div>

</div>

</div>

<!-- Content -->
<div class="content">

<h1>BLADE BOX MASTER</h1>

<label>Enter Box Name</label>
<input type="text" id="boxName" placeholder="Enter Box Name">

<button onclick="saveBox()">Save</button>

<hr>

<label>Search Box</label>
<input type="text" id="searchInput" onkeyup="searchBox()" placeholder="Search...">

<br><br>

<table>

<thead>
<tr>
<th>ID</th>
<th>Box Name</th>
<th>Actions</th>
</tr>
</thead>

<tbody id="boxTable"></tbody>

</table>

</div>

<script>

let editId=null;

/* Sidebar */
function toggleMenu(id){
const m=document.getElementById(id);
m.style.display=(m.style.display==="block")?"none":"block";
}

function openPage(page){
window.location.href=page;
}

/* Load Boxes */

function loadBoxes(){

fetch('/api/blade_boxes')
.then(res=>res.json())
.then(data=>{

const table=document.getElementById("boxTable");

table.innerHTML="";

data.forEach(item=>{

table.innerHTML+=`
<tr>
<td>${item.id}</td>
<td>${item.box_name}</td>
<td>
<button class="action-btn" onclick="setEdit(${item.id},'${item.box_name}')">Edit</button>
<button class="action-btn" onclick="deleteBox(${item.id})">Delete</button>
</td>
</tr>
`;

});

});

}

/* Save */

function saveBox(){

const name=document.getElementById("boxName").value.trim();

if(!name){
alert("Enter Box Name");
return;
}

if(editId===null){

fetch('/api/blade_boxes',{

method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({box_name:name})

}).then(()=>{
document.getElementById("boxName").value="";
loadBoxes();
});

}

else{

fetch(`/api/blade_boxes/${editId}`,{

method:'PUT',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({box_name:name})

}).then(()=>{

editId=null;
document.getElementById("boxName").value="";
loadBoxes();

});

}

}

/* Edit */

function setEdit(id,name){

editId=id;
document.getElementById("boxName").value=name;

}

/* Delete */

function deleteBox(id){

if(!confirm("Delete this box?")) return;

fetch(`/api/blade_boxes/${id}`,{

method:'DELETE'

}).then(loadBoxes);

}

/* Search */

function searchBox(){

const keyword=document.getElementById("searchInput").value.toLowerCase();

const rows=document.querySelectorAll("#boxTable tr");

rows.forEach(row=>{

const text=row.innerText.toLowerCase();

row.style.display=text.includes(keyword)?"":"none";

});

}

loadBoxes();

</script>

</body>
</html>